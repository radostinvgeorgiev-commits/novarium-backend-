// agent/core/core.js â€“ SYNCHRON-X Agent Core

const taskRunner = require("./taskRunner");
const heartbeatTask = require("../tasks/heartbeat.task");

class AgentCore {
  constructor() {
    this.tasks = [heartbeatTask];
    this.status = "IDLE";
  }

  async run() {
    this.status = "RUNNING";
    console.log("ðŸ” AGENT: Starting task cycleâ€¦");

    for (const task of this.tasks) {
      try {
        await taskRunner.execute(task);
      } catch (err) {
        console.error("âŒ AGENT TASK ERROR:", err);
      }
    }

    this.status = "IDLE";
  }

  getStatus() {
    return {
      agent: "SYNCHRON-X",
      status: this.status,
      tasks: this.tasks.map(t => t.name),
      time: new Date().toISOString(),
    };
  }
}

module.exports = new AgentCore();
